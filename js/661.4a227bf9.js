"use strict";(self["webpackChunkoh"]=self["webpackChunkoh"]||[]).push([[661],{9661:function(t,a,e){e.r(a),e.d(a,{default:function(){return P}});var s=e(6768),l=e(4232),o=e(5130);const i={class:"cart"},d={class:"container"},c={class:"cart-function"},r={class:"row"},n={class:"col-12"},u={class:"table-responsive"},m={class:"table"},p={scope:"row"},h={class:"product-detail d-flex align-items-center"},k={class:"product-image me-3"},L=["src"],b={class:"product-title"},g={key:0,class:"text-success"},f={class:"input-group input-group-sm"},v=["onUpdate:modelValue","onChange","disabled"],C={class:"input-group-text"},y={class:"align-middle"},x={key:0,class:"text-success"},V={class:"align-middle"},_=["onClick","disabled"],F={class:"text-end"},I={key:0},$={class:"text-end text-success"},E={class:"col-6"},U={class:"input-group mb-3 input-group-sm"},q={class:"input-group-append"},w={class:"col-12"},X={class:"mb-3"},A={class:"mb-3"},Q={class:"mb-3"},J={class:"mb-3"},K={class:"mb-3"};function M(t,a,e,M,O,S){const j=(0,s.g2)("Loading"),P=(0,s.g2)("font-awesome-icon"),R=(0,s.g2)("Field"),z=(0,s.g2)("ErrorMessage"),B=(0,s.g2)("Form");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(j,{active:O.isLoading},null,8,["active"]),(0,s.Lk)("div",i,[(0,s.Lk)("div",d,[(0,s.Lk)("div",c,[a[8]||(a[8]=(0,s.Lk)("h5",{class:"title"},"My Cart",-1)),(0,s.Lk)("button",{type:"button",class:"btn btn-dark delete-all",onClick:a[0]||(a[0]=(...t)=>S.removeAllCartItem&&S.removeAllCartItem(...t))},"全部刪除")]),(0,s.Lk)("div",r,[(0,s.Lk)("div",n,[(0,s.Lk)("div",u,[(0,s.Lk)("table",m,[a[12]||(a[12]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{scope:"col"},"品名"),(0,s.Lk)("th",{scope:"col"},"數量"),(0,s.Lk)("th",{scope:"col"},"單價"),(0,s.Lk)("th",{scope:"col"},"功能")])],-1)),(0,s.Lk)("tbody",null,[O.cart.carts?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:0},(0,s.pI)(O.cart.carts,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.id},[(0,s.Lk)("th",p,[(0,s.Lk)("div",h,[(0,s.Lk)("div",k,[(0,s.Lk)("img",{src:e.product.imageUrl,alt:"",class:"img-fluid rounded border-0 mb-3"},null,8,L)]),(0,s.Lk)("div",null,[(0,s.Lk)("div",b,(0,l.v_)(e.product.title),1),e.coupon?((0,s.uX)(),(0,s.CE)("div",g," 已套用優惠券 ")):(0,s.Q3)("",!0)])])]),(0,s.Lk)("td",null,[(0,s.Lk)("div",f,[(0,s.bo)((0,s.Lk)("input",{type:"number",class:"form-control","onUpdate:modelValue":t=>e.qty=t,min:"1",onChange:t=>S.updateCart(e),disabled:e.id===O.status.loadingItem},null,40,v),[[o.Jo,e.qty,void 0,{number:!0}]]),(0,s.Lk)("div",C,"/ "+(0,l.v_)(e.product.unit),1)])]),(0,s.Lk)("td",y,[(0,s.Lk)("div",null,[O.cart.final_total!==O.cart.total?((0,s.uX)(),(0,s.CE)("small",x,"折扣價")):(0,s.Q3)("",!0),(0,s.Lk)("div",null,(0,l.v_)(t.$filters.currency(e.final_total)),1)])]),(0,s.Lk)("td",V,[(0,s.Lk)("button",{type:"button",class:"btn btn-outline-danger",onClick:t=>S.removeCartItem(e.id),disabled:O.status.loadingItem===e.id},[a[9]||(a[9]=(0,s.Lk)("i",{class:"fas fas-spinner fa-spin"},null,-1)),(0,s.bF)(P,{class:"bars",icon:"fas fa-trash"})],8,_)])])))),128)):(0,s.Q3)("",!0)]),(0,s.Lk)("tfoot",null,[(0,s.Lk)("tr",null,[a[10]||(a[10]=(0,s.Lk)("td",{class:"text-end",colspan:"3"},"總計",-1)),(0,s.Lk)("td",F,(0,l.v_)(t.$filters.currency(O.cart.total)),1)]),O.cart.final_total!==O.cart.total?((0,s.uX)(),(0,s.CE)("tr",I,[a[11]||(a[11]=(0,s.Lk)("td",{class:"text-end text-success",colspan:"3"},"折扣價",-1)),(0,s.Lk)("td",$,(0,l.v_)(t.$filters.currency(O.cart.final_total)),1)])):(0,s.Q3)("",!0)])])])]),a[20]||(a[20]=(0,s.Lk)("div",{class:"col-6"},null,-1)),(0,s.Lk)("div",E,[(0,s.Lk)("div",U,[(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":a[1]||(a[1]=t=>O.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[o.Jo,O.coupon_code]]),(0,s.Lk)("div",q,[(0,s.Lk)("button",{class:"btn btn-outline-secondary",type:"button",onClick:a[2]||(a[2]=(...t)=>S.addCouponCode&&S.addCouponCode(...t))}," 套用優惠碼 ")])])]),(0,s.Lk)("div",w,[a[19]||(a[19]=(0,s.Lk)("div",{class:"form"},[(0,s.Lk)("h5",{class:"title"},"收件人資訊")],-1)),(0,s.bF)(B,{class:"mt-4",onSubmit:S.createOrder},{default:(0,s.k6)((({errors:t})=>[(0,s.Lk)("div",X,[a[13]||(a[13]=(0,s.Lk)("label",{for:"email",class:"form-label"},"Email",-1)),(0,s.bF)(R,{id:"email",name:"email",type:"email",class:(0,l.C4)(["form-control",{"is-invalid":t["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:O.form.user.email,"onUpdate:modelValue":a[3]||(a[3]=t=>O.form.user.email=t)},null,8,["class","modelValue"]),(0,s.bF)(z,{name:"email",class:"invalid-feedback"})]),(0,s.Lk)("div",A,[a[14]||(a[14]=(0,s.Lk)("label",{for:"name",class:"form-label"},"收件人姓名",-1)),(0,s.bF)(R,{id:"name",name:"姓名",type:"text",class:(0,l.C4)(["form-control",{"is-invalid":t["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:O.form.user.name,"onUpdate:modelValue":a[4]||(a[4]=t=>O.form.user.name=t)},null,8,["class","modelValue"]),(0,s.bF)(z,{name:"姓名",class:"invalid-feedback"})]),(0,s.Lk)("div",Q,[a[15]||(a[15]=(0,s.Lk)("label",{for:"tel",class:"form-label"},"收件人電話",-1)),(0,s.bF)(R,{id:"tel",name:"電話",type:"tel",class:(0,l.C4)(["form-control",{"is-invalid":t["電話"]}]),placeholder:"請輸入電話",rules:"required",modelValue:O.form.user.tel,"onUpdate:modelValue":a[5]||(a[5]=t=>O.form.user.tel=t)},null,8,["class","modelValue"]),(0,s.bF)(z,{name:"電話",class:"invalid-feedback"})]),(0,s.Lk)("div",J,[a[16]||(a[16]=(0,s.Lk)("label",{for:"address",class:"form-label"},"收件人地址",-1)),(0,s.bF)(R,{id:"address",name:"地址",type:"text",class:(0,l.C4)(["form-control",{"is-invalid":t["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:O.form.user.address,"onUpdate:modelValue":a[6]||(a[6]=t=>O.form.user.address=t)},null,8,["class","modelValue"]),(0,s.bF)(z,{name:"地址",class:"invalid-feedback"})]),(0,s.Lk)("div",K,[a[17]||(a[17]=(0,s.Lk)("label",{for:"message",class:"form-label"},"留言",-1)),(0,s.bo)((0,s.Lk)("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":a[7]||(a[7]=t=>O.form.message=t)},null,512),[[o.Jo,O.form.message]])]),a[18]||(a[18]=(0,s.Lk)("div",{class:"text-end"},[(0,s.Lk)("button",{class:"btn btn-dark submit-btn"},"送出訂單")],-1))])),_:1},8,["onSubmit"])])])])])],64)}var O={data(){return{products:[],product:{},cart:[],coupon_code:"",status:{loadingItem:""},form:{user:{name:"",email:"",tel:"",address:""},message:""},isLoading:!1}},inject:["emitter"],methods:{getCart(){const t="https://vue3-course-api.hexschool.io/api/aida-api/cart";this.isLoading=!0,this.$http.get(t).then((t=>{this.isLoading=!1,console.log("API Response",t.data),t.data.data&&t.data.data.carts?this.cart=t.data.data:this.cart=[]}))},updateCart(t){const a=`https://vue3-course-api.hexschool.io/api/aida-api/cart/${t.id}`;this.status.loadingItem=t.id;const e={product_id:t.product_id,qty:t.qty};this.isLoading=!0,this.$http.put(a,{data:e}).then((t=>{this.isLoading=!1,this.status.loadingItem="",this.getCart(),this.emitter.emit("cart-updated")}))},removeCartItem(t){this.status.loadingItem=t;const a=`https://vue3-course-api.hexschool.io/api/aida-api/cart/${t}`;this.isLoading=!0,this.$http.delete(a).then((t=>{this.isLoading=!1,this.status.loadingItem="",this.getCart()}))},removeAllCartItem(){const t="https://vue3-course-api.hexschool.io/api/aida-api/carts";this.isLoading=!0,this.$http.delete(t).then((t=>{this.isLoading=!1,this.getCart()}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/aida-api/coupon",a={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:a}).then((t=>{this.isLoading=!1,console.log(t.data),this.getCart()}))},createOrder(){const t="https://vue3-course-api.hexschool.io/api/aida-api/order",a=this.form;this.isLoading=!0,this.$http.post(t,{data:a}).then((t=>{this.isLoading=!1,console.log(t)}))}},created(){this.emitter.on("addCart",(t=>{this.cart=t})),this.getCart()}},S=e(1241);const j=(0,S.A)(O,[["render",M]]);var P=j}}]);
//# sourceMappingURL=661.4a227bf9.js.map