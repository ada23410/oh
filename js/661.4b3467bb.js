"use strict";(self["webpackChunkoh"]=self["webpackChunkoh"]||[]).push([[661],{9661:function(t,e,a){a.r(e),a.d(e,{default:function(){return T}});var s=a(6768),l=a(4232),o=a(5130);const i={class:"cart"},d={class:"container"},n={class:"cart-function"},r={class:"row"},c={class:"col-12"},u={class:"table-responsive"},m={class:"table"},p={scope:"row"},L={class:"product-detail d-flex align-items-center"},h={class:"product-image me-3"},k=["src"],b={class:"product-title"},_={key:0,class:"text-success"},g={class:"input-group input-group-sm"},f=["onUpdate:modelValue","onChange","disabled"],E={class:"input-group-text"},v={class:"align-middle"},A={key:0,class:"text-success"},V={class:"align-middle"},C=["onClick","disabled"],P={class:"text-end"},U={key:0},y={class:"text-end text-success"},N={class:"col-6"},$={class:"input-group mb-3 input-group-sm"},I={class:"input-group-append"},x={class:"col-12"},F={class:"mb-3"},O={class:"mb-3"},S={class:"mb-3"},R={class:"mb-3"},B={class:"mb-3"};function D(t,e,a,D,q,w){const H=(0,s.g2)("Loading"),T=(0,s.g2)("font-awesome-icon"),X=(0,s.g2)("Field"),Q=(0,s.g2)("ErrorMessage"),J=(0,s.g2)("Form");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(H,{active:q.isLoading},null,8,["active"]),(0,s.Lk)("div",i,[(0,s.Lk)("div",d,[(0,s.Lk)("div",n,[e[8]||(e[8]=(0,s.Lk)("h5",{class:"title"},"My Cart",-1)),(0,s.Lk)("button",{type:"button",class:"btn btn-dark delete-all",onClick:e[0]||(e[0]=(...t)=>w.removeAllCartItem&&w.removeAllCartItem(...t))},"全部刪除")]),(0,s.Lk)("div",r,[(0,s.Lk)("div",c,[(0,s.Lk)("div",u,[(0,s.Lk)("table",m,[e[12]||(e[12]=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{scope:"col"},"品名"),(0,s.Lk)("th",{scope:"col"},"數量"),(0,s.Lk)("th",{scope:"col"},"單價"),(0,s.Lk)("th",{scope:"col"},"功能")])],-1)),(0,s.Lk)("tbody",null,[q.cart.carts?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:0},(0,s.pI)(q.cart.carts,(a=>((0,s.uX)(),(0,s.CE)("tr",{key:a.id},[(0,s.Lk)("th",p,[(0,s.Lk)("div",L,[(0,s.Lk)("div",h,[(0,s.Lk)("img",{src:a.product.imageUrl,alt:"",class:"img-fluid rounded border-0 mb-3"},null,8,k)]),(0,s.Lk)("div",null,[(0,s.Lk)("div",b,(0,l.v_)(a.product.title),1),a.coupon?((0,s.uX)(),(0,s.CE)("div",_," 已套用優惠券 ")):(0,s.Q3)("",!0)])])]),(0,s.Lk)("td",null,[(0,s.Lk)("div",g,[(0,s.bo)((0,s.Lk)("input",{type:"number",class:"form-control","onUpdate:modelValue":t=>a.qty=t,min:"1",onChange:t=>w.updateCart(a),disabled:a.id===q.status.loadingItem},null,40,f),[[o.Jo,a.qty,void 0,{number:!0}]]),(0,s.Lk)("div",E,"/ "+(0,l.v_)(a.product.unit),1)])]),(0,s.Lk)("td",v,[(0,s.Lk)("div",null,[q.cart.final_total!==q.cart.total?((0,s.uX)(),(0,s.CE)("small",A,"折扣價")):(0,s.Q3)("",!0),(0,s.Lk)("div",null,(0,l.v_)(t.$filters.currency(a.final_total)),1)])]),(0,s.Lk)("td",V,[(0,s.Lk)("button",{type:"button",class:"btn btn-outline-danger",onClick:t=>w.removeCartItem(a.id),disabled:q.status.loadingItem===a.id},[e[9]||(e[9]=(0,s.Lk)("i",{class:"fas fas-spinner fa-spin"},null,-1)),(0,s.bF)(T,{class:"bars",icon:"fas fa-trash"})],8,C)])])))),128)):(0,s.Q3)("",!0)]),(0,s.Lk)("tfoot",null,[(0,s.Lk)("tr",null,[e[10]||(e[10]=(0,s.Lk)("td",{class:"text-end",colspan:"3"},"總計",-1)),(0,s.Lk)("td",P,(0,l.v_)(t.$filters.currency(q.cart.total)),1)]),q.cart.final_total!==q.cart.total?((0,s.uX)(),(0,s.CE)("tr",U,[e[11]||(e[11]=(0,s.Lk)("td",{class:"text-end text-success",colspan:"3"},"折扣價",-1)),(0,s.Lk)("td",y,(0,l.v_)(t.$filters.currency(q.cart.final_total)),1)])):(0,s.Q3)("",!0)])])])]),e[20]||(e[20]=(0,s.Lk)("div",{class:"col-6"},null,-1)),(0,s.Lk)("div",N,[(0,s.Lk)("div",$,[(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[1]||(e[1]=t=>q.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[o.Jo,q.coupon_code]]),(0,s.Lk)("div",I,[(0,s.Lk)("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[2]||(e[2]=(...t)=>w.addCouponCode&&w.addCouponCode(...t))}," 套用優惠碼 ")])])]),(0,s.Lk)("div",x,[e[19]||(e[19]=(0,s.Lk)("div",{class:"form"},[(0,s.Lk)("h5",{class:"title"},"收件人資訊")],-1)),(0,s.bF)(J,{class:"mt-4",onSubmit:w.createOrder},{default:(0,s.k6)((({errors:t})=>[(0,s.Lk)("div",F,[e[13]||(e[13]=(0,s.Lk)("label",{for:"email",class:"form-label"},"Email",-1)),(0,s.bF)(X,{id:"email",name:"email",type:"email",class:(0,l.C4)(["form-control",{"is-invalid":t["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:q.form.user.email,"onUpdate:modelValue":e[3]||(e[3]=t=>q.form.user.email=t)},null,8,["class","modelValue"]),(0,s.bF)(Q,{name:"email",class:"invalid-feedback"})]),(0,s.Lk)("div",O,[e[14]||(e[14]=(0,s.Lk)("label",{for:"name",class:"form-label"},"收件人姓名",-1)),(0,s.bF)(X,{id:"name",name:"姓名",type:"text",class:(0,l.C4)(["form-control",{"is-invalid":t["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:q.form.user.name,"onUpdate:modelValue":e[4]||(e[4]=t=>q.form.user.name=t)},null,8,["class","modelValue"]),(0,s.bF)(Q,{name:"姓名",class:"invalid-feedback"})]),(0,s.Lk)("div",S,[e[15]||(e[15]=(0,s.Lk)("label",{for:"tel",class:"form-label"},"收件人電話",-1)),(0,s.bF)(X,{id:"tel",name:"電話",type:"tel",class:(0,l.C4)(["form-control",{"is-invalid":t["電話"]}]),placeholder:"請輸入電話",rules:"required",modelValue:q.form.user.tel,"onUpdate:modelValue":e[5]||(e[5]=t=>q.form.user.tel=t)},null,8,["class","modelValue"]),(0,s.bF)(Q,{name:"電話",class:"invalid-feedback"})]),(0,s.Lk)("div",R,[e[16]||(e[16]=(0,s.Lk)("label",{for:"address",class:"form-label"},"收件人地址",-1)),(0,s.bF)(X,{id:"address",name:"地址",type:"text",class:(0,l.C4)(["form-control",{"is-invalid":t["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:q.form.user.address,"onUpdate:modelValue":e[6]||(e[6]=t=>q.form.user.address=t)},null,8,["class","modelValue"]),(0,s.bF)(Q,{name:"地址",class:"invalid-feedback"})]),(0,s.Lk)("div",B,[e[17]||(e[17]=(0,s.Lk)("label",{for:"message",class:"form-label"},"留言",-1)),(0,s.bo)((0,s.Lk)("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":e[7]||(e[7]=t=>q.form.message=t)},null,512),[[o.Jo,q.form.message]])]),e[18]||(e[18]=(0,s.Lk)("div",{class:"text-end"},[(0,s.Lk)("button",{class:"btn btn-dark submit-btn"},"送出訂單")],-1))])),_:1},8,["onSubmit"])])])])])],64)}var q={data(){return{products:[],product:{},cart:[],coupon_code:"",status:{loadingItem:""},form:{user:{name:"",email:"",tel:"",address:""},message:""},isLoading:!1}},inject:["emitter"],methods:{getCart(){const t=`${{NODE_ENV:"production",BASE_URL:"/oh/"}.VUE_APP_API}api/${{NODE_ENV:"production",BASE_URL:"/oh/"}.VUE_APP_PATH}/cart`;this.isLoading=!0,this.$http.get(t).then((t=>{this.isLoading=!1,console.log("API Response",t.data),t.data.data&&t.data.data.carts?this.cart=t.data.data:this.cart=[]}))},updateCart(t){const e=`${{NODE_ENV:"production",BASE_URL:"/oh/"}.VUE_APP_API}api/${{NODE_ENV:"production",BASE_URL:"/oh/"}.VUE_APP_PATH}/cart/${t.id}`;this.status.loadingItem=t.id;const a={product_id:t.product_id,qty:t.qty};this.isLoading=!0,this.$http.put(e,{data:a}).then((t=>{this.isLoading=!1,this.status.loadingItem="",this.getCart(),this.emitter.emit("cart-updated")}))},removeCartItem(t){this.status.loadingItem=t;const e=`${{NODE_ENV:"production",BASE_URL:"/oh/"}.VUE_APP_API}api/${{NODE_ENV:"production",BASE_URL:"/oh/"}.VUE_APP_PATH}/cart/${t}`;this.isLoading=!0,this.$http.delete(e).then((t=>{this.isLoading=!1,this.status.loadingItem="",this.getCart()}))},removeAllCartItem(){const t=`${{NODE_ENV:"production",BASE_URL:"/oh/"}.VUE_APP_API}api/${{NODE_ENV:"production",BASE_URL:"/oh/"}.VUE_APP_PATH}/carts`;this.isLoading=!0,this.$http.delete(t).then((t=>{this.isLoading=!1,this.getCart()}))},addCouponCode(){const t=`${{NODE_ENV:"production",BASE_URL:"/oh/"}.VUE_APP_API}api/${{NODE_ENV:"production",BASE_URL:"/oh/"}.VUE_APP_PATH}/coupon`,e={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:e}).then((t=>{this.isLoading=!1,console.log(t.data),this.getCart()}))},createOrder(){const t=`${{NODE_ENV:"production",BASE_URL:"/oh/"}.VUE_APP_API}api/${{NODE_ENV:"production",BASE_URL:"/oh/"}.VUE_APP_PATH}/order`,e=this.form;this.isLoading=!0,this.$http.post(t,{data:e}).then((t=>{this.isLoading=!1,console.log(t)}))}},created(){this.emitter.on("addCart",(t=>{this.cart=t})),this.getCart()}},w=a(1241);const H=(0,w.A)(q,[["render",D]]);var T=H}}]);
//# sourceMappingURL=661.4b3467bb.js.map