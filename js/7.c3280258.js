"use strict";(self["webpackChunkoh"]=self["webpackChunkoh"]||[]).push([[7],{8007:function(t,e,l){l.r(e),l.d(e,{default:function(){return q}});var a=l(6768),i=l(4232);const o={class:"function"},s={class:"card p-3"},c={class:"table"},r={class:"text-right"},d={class:"text-right"},n={key:0,class:"text-success"},p={key:1,class:"text-mute"},m={class:"btn-group"},u=["onClick"],h=["onClick"];function b(t,e,l,b,k,L){const f=(0,a.g2)("articleModal"),A=(0,a.g2)("deleteArticleModal");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",o,[e[1]||(e[1]=(0,a.Lk)("h5",null,"文章管理",-1)),(0,a.Lk)("button",{class:"btn btn-primary",type:"button",onClick:e[0]||(e[0]=t=>L.openModal(!0))},"新增文章")]),(0,a.Lk)("div",s,[(0,a.Lk)("table",c,[e[2]||(e[2]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{width:"120"},"標題"),(0,a.Lk)("th",{width:"120"},"敘述"),(0,a.Lk)("th",{width:"120"},"作者"),(0,a.Lk)("th",{width:"120"},"建立日期"),(0,a.Lk)("th",{width:"100"},"是否啟用"),(0,a.Lk)("th",{width:"120"},"編輯")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(k.articles,((e,l)=>((0,a.uX)(),(0,a.CE)("tr",{key:l},[(0,a.Lk)("td",null,(0,i.v_)(e.title),1),(0,a.Lk)("td",null,(0,i.v_)(e.description),1),(0,a.Lk)("td",r,(0,i.v_)(e.author),1),(0,a.Lk)("td",d,(0,i.v_)(t.$filters.date(e.create_at)),1),(0,a.Lk)("td",null,[e.isPublic?((0,a.uX)(),(0,a.CE)("span",n,"啟用")):((0,a.uX)(),(0,a.CE)("span",p,"未啟用"))]),(0,a.Lk)("td",null,[(0,a.Lk)("div",m,[(0,a.Lk)("button",{class:"btn btn-outline-primary btn-sm",onClick:t=>L.openModal(!1,e)},"編輯",8,u),(0,a.Lk)("button",{class:"btn btn-outline-danger btn-sm",onClick:t=>L.openDeleteArticleModal(e)},"刪除",8,h)])])])))),128))])])]),(0,a.bF)(f,{ref:"articleModal",article:k.tempArticle,onUpdateArticle:L.updateArticle},null,8,["article","onUpdateArticle"]),(0,a.bF)(A,{ref:"deleteArticleModal",onConfirmDelete:L.deleteArticle},null,8,["onConfirmDelete"])],64)}var k=l(5130);const L={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},f={class:"modal-dialog modal-xl",role:"document"},A={class:"modal-content"},g={class:"modal-body"},v={class:"row"},M={class:"col-md-4"},x={class:"mb-3"},y={class:"mb-3"},w=["src"],C={class:"col-md-8"},$={class:"mb-3"},U={class:"mb-3"},_={class:"mb-3"},F={class:"mb-3"},V={class:"mb-3"},J={class:"mb-3"},D={class:"mb-3"},E={class:"form-check"},P={class:"modal-footer"};function X(t,e,l,i,o,s){return(0,a.uX)(),(0,a.CE)("div",L,[(0,a.Lk)("div",f,[(0,a.Lk)("div",A,[e[20]||(e[20]=(0,a.Lk)("div",{class:"modal-header bg-dark text-white"},[(0,a.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"},"新增文章"),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,a.Lk)("div",g,[(0,a.Lk)("div",v,[(0,a.Lk)("div",M,[(0,a.Lk)("div",x,[e[10]||(e[10]=(0,a.Lk)("label",{for:"image",class:"form-label"},"輸入圖片網址",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=t=>o.tempArticle.imageUrl=t)},null,512),[[k.Jo,o.tempArticle.imageUrl]])]),(0,a.Lk)("div",y,[e[11]||(e[11]=(0,a.Lk)("label",{for:"customFile",class:"form-label"},[(0,a.eW)("或上傳圖片 "),(0,a.Lk)("i",{class:"fas fa-spinner fa-spin"})],-1)),(0,a.Lk)("input",{type:"file",id:"customFile",class:"form-control",ref:"fileInput",onChange:e[1]||(e[1]=(...e)=>t.uploadFile&&t.uploadFile(...e))},null,544)]),(0,a.Lk)("img",{class:"img-fluid",src:o.tempArticle.imageUrl,alt:""},null,8,w)]),(0,a.Lk)("div",C,[(0,a.Lk)("div",$,[e[12]||(e[12]=(0,a.Lk)("label",{for:"title",class:"form-label"},"標題",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":e[2]||(e[2]=t=>o.tempArticle.title=t),placeholder:"請輸入標題"},null,512),[[k.Jo,o.tempArticle.title]])]),(0,a.Lk)("div",U,[e[13]||(e[13]=(0,a.Lk)("label",{for:"author",class:"form-label"},"作者",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"author","onUpdate:modelValue":e[3]||(e[3]=t=>o.tempArticle.author=t),placeholder:"請輸入作者"},null,512),[[k.Jo,o.tempArticle.author]])]),(0,a.Lk)("div",_,[e[14]||(e[14]=(0,a.Lk)("label",{for:"description",class:"form-label"},"文章敘述",-1)),(0,a.bo)((0,a.Lk)("textarea",{type:"text",class:"form-control",id:"description","onUpdate:modelValue":e[4]||(e[4]=t=>o.tempArticle.description=t),placeholder:"請輸入敘述"},null,512),[[k.Jo,o.tempArticle.description]])]),(0,a.Lk)("div",F,[e[15]||(e[15]=(0,a.Lk)("label",{for:"content",class:"form-label"},"內容",-1)),(0,a.bo)((0,a.Lk)("textarea",{type:"text",class:"form-control",id:"content","onUpdate:modelValue":e[5]||(e[5]=t=>o.tempArticle.content=t),placeholder:"請輸入內容",rows:"10",cols:"30"},null,512),[[k.Jo,o.tempArticle.content]])]),(0,a.Lk)("div",V,[e[16]||(e[16]=(0,a.Lk)("label",{for:"tag",class:"form-label"},"分類",-1)),(0,a.bo)((0,a.Lk)("textarea",{type:"text",class:"form-control",id:"tag","onUpdate:modelValue":e[6]||(e[6]=t=>o.tempArticle.tag=t),placeholder:"請輸入關鍵字"},null,512),[[k.Jo,o.tempArticle.tag]])]),(0,a.Lk)("div",J,[e[17]||(e[17]=(0,a.Lk)("label",{for:"create_at"},"建立日期",-1)),(0,a.bo)((0,a.Lk)("input",{type:"date",class:"form-control",id:"create_at","onUpdate:modelValue":e[7]||(e[7]=t=>o.create_at=t)},null,512),[[k.Jo,o.create_at]])]),(0,a.Lk)("div",D,[(0,a.Lk)("div",E,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=t=>o.tempArticle.isPublic=t),id:"isPublic"},null,512),[[k.lH,o.tempArticle.isPublic]]),e[18]||(e[18]=(0,a.Lk)("label",{class:"form-check-label",for:"isPublic"}," 是否啟用 ",-1))])])])])]),(0,a.Lk)("div",P,[e[19]||(e[19]=(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=e=>t.$emit("update-article",o.tempArticle))},"確認 ")])])])],512)}var N=l(3286),S={name:"articleModal",props:{article:{type:Object,default(){return{}}}},watch:{article(){this.tempArticle=this.article}},data(){return{tempArticle:{isPublic:!1},create_at:""}},methods:{convertDate(){this.tempArticle.create_at=Math.floor(new Date(this.tempArticle.create_at)/1e3)}},mixins:[N.A],inject:["emitter"],emits:["update-article"]},j=l(1241);const I=(0,j.A)(S,[["render",X]]);var K=I,H=l(3773),O={components:{articleModal:K,deleteArticleModal:H.A},data(){return{articles:{},tempArticle:{},pagination:{},isNew:!1}},methods:{getArticles(){const t="https://vue3-course-api.hexschool.io/api/aida-api/admin/articles";this.$http.get(t).then((t=>{this.articles=t.data.articles,this.pagination=t.data.pagination}))},openModal(t,e){this.isNew?this.tempArticle={}:this.tempArticle={...e},this.isNew=t;const l=this.$refs.articleModal;l.showModal()},openDeleteArticleModal(t){this.tempArticle={...t};const e=this.$refs.deleteArticleModal;e.showModal()},updateArticle(){if(this.isNew){const t="https://vue3-course-api.hexschool.io/api/aida-api/admin/article",e=this.$refs.articleModal;console.log("新增前的文章内容:",this.tempArticle),this.$http.post(t,{data:this.tempArticle}).then((t=>{console.log("新增文章",t.data),this.$httpMessageState(t,"新增文章"),this.getArticles(),e.hideModal()}))}else{const t=`https://vue3-course-api.hexschool.io/api/aida-api/admin/article/${this.tempArticle.id}`,e=this.$refs.articleModal;console.log("更新前的文章内容:",this.tempArticle),this.$http.put(t,{data:this.tempArticle}).then((t=>{console.log("更新文章",t),this.$httpMessageState(t,"更新文章"),this.getArticles(),e.hideModal()}))}},deleteArticle(){const t=`https://vue3-course-api.hexschool.io/api/aida-api/admin/article/${this.tempArticle.id}`,e=this.$refs.deleteArticleModal;this.$http.delete(t).then((t=>{this.$httpMessageState(t,"刪除文章"),e.hideModal(),this.getArticles()}))}},created(){this.getArticles()}};const W=(0,j.A)(O,[["render",b]]);var q=W}}]);
//# sourceMappingURL=7.c3280258.js.map